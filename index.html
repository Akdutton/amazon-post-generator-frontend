<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amazon Post Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      color: #333;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    textarea, input, select, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    button {
      background: #007bff;
      color: white;
      cursor: pointer;
      border: none;
    }
    button:hover {
      background: #0056b3;
    }
    .output {
      margin-top: 15px;
      padding: 10px;
      border: 1px dashed #007bff;
      border-radius: 6px;
      background: #e9f2ff;
      white-space: pre-wrap;
    }
    .btn-inline {
      width: auto;
      display: inline-block;
      margin-top: 5px;
      margin-right: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Amazon Post Generator</h2>

    <label for="textInput">Product Description:</label>
    <textarea id="textInput" rows="4"></textarea>

    <label for="urlInput">Product Link:</label>
    <input type="url" id="urlInput" placeholder="https://example.com/product">

    <label for="codeInput">Discount Code (optional):</label>
    <input type="text" id="codeInput" placeholder="Enter code if any">

    <label for="modelSelect">Choose AI Model:</label>
    <select id="modelSelect">
      <option value="qwen/qwen-2.5-vl-7b-instruct:free">Qwen2.5-VL 7B Instruct (Free)</option>
      <option value="mistralai/mistral-small-3.1-24b-instruct:free">Mistral: Mistral Small 3.1 24B (Free)</option>
      <option value="tngtech/deepseek-r1t2-chimera:free">TNG Tech: DeepSeek R1T2 Chimera (Free)</option>
      <option value="liquid/lfm-2.5-1.2b-thinking:free">Liquid: LFM 2.5 1.2B Thinking (Free)</option>
      <option value="liquid/lfm-2.5-1.2b-instruct:free">Liquid: LFM 2.5 1.2B Instruct (Free)</option>
      <option value="allenai/molmo-2-8b:free">AllenAI: Molmo 2 8B (Free)</option>
      <option value="google/gemma-3n-e4b-it:free">Gemma 3N E4B (Free)</option>
      <option value="meta-llama/llama-3.1-405b-instruct:free">Meta: Llama 3.1 405B Instruct (Free)</option>
    </select>

    <button id="generateBtn">Generate Post</button>

    <div class="output" id="outputArea"></div>
    <button class="btn-inline" id="copyBtn">Copy</button>
    <button class="btn-inline" id="clearBtn">Clear</button>
  </div>

  <script>
    const generateBtn = document.getElementById("generateBtn");
    const outputArea = document.getElementById("outputArea");
    const copyBtn = document.getElementById("copyBtn");
    const clearBtn = document.getElementById("clearBtn");

    generateBtn.addEventListener("click", async () => {
      const text = document.getElementById("textInput").value.trim();
      const url = document.getElementById("urlInput").value.trim();
      const code = document.getElementById("codeInput").value.trim();
      const model = document.getElementById("modelSelect").value;

      if (!text || !url) {
        alert("Please enter both description and product link.");
        return;
      }

      outputArea.textContent = "Generating...";
      const backendUrl = "https://amazon-post-generator-backend.onrender.com";
      try {
        const response = await fetch(`${backendUrl}/api/rewrite`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text, url, code, model })
        });

        const data = await response.json();

        if (response.ok) {
          outputArea.textContent = `${data.output}\n\n#AmazonFinds #AllAboutSavings ${data.productHashtag ? data.productHashtag : ""}\nReach Score: ${data.reachScore}`;
        } else {
          outputArea.textContent = `Error: ${data.error || "Unknown error"}`;
        }
      } catch (err) {
        outputArea.textContent = "Network or server error: " + err.message;
      }
    });

    copyBtn.addEventListener("click", () => {
      navigator.clipboard.writeText(outputArea.textContent);
      alert("Copied to clipboard!");
    });

    clearBtn.addEventListener("click", () => {
      document.getElementById("textInput").value = "";
      document.getElementById("urlInput").value = "";
      document.getElementById("codeInput").value = "";
      outputArea.textContent = "";
    });
  </script>
</body>
</html>
